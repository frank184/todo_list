$modal = $('.modal');
if ($modal.length > 0) {
    $('.modal').modal('hide').after(function(){
        console.log('removed .modal-backdrop.fade.in');
        $('.modal-backdrop.fade.in').remove();
        $('#modal').html('<%= j render "devise/sessions/new" %>');
        $('#new_session').modal('show');
    });
} else {
    $('#modal').html('<%= j render "devise/sessions/new" %>');
    $('#new_session').modal('show');
}